# Detection Thresholds Configuration
# This file contains tunable parameters for cryptographic analysis algorithms
# Modify these values to adjust detection sensitivity and accuracy

# Language Detection Configuration
language_detection:
  # Supported languages for detection
  supported_languages: ['english', 'spanish', 'french', 'german', 'italian', 'portuguese', 'russian', 'chinese']

  # Penalization factors for similar languages
  penalization_factors:
    latin_languages: 0.2  # Penalty multiplier for French, Italian, Portuguese
    german: 0.3  # Penalty multiplier for German vs English

  # Ambiguity handling thresholds
  ambiguity:
    difference_threshold: 0.05  # Minimum difference ratio between top 2 scores (5%)
    preference_threshold: 0.98  # Score threshold for preferring non-penalized languages (98%)

# Cipher Identifier Configuration
cipher_identifier:
  # Caesar cipher detection thresholds
  caesar_test:
    primary_threshold:
      score: 0.5          # Minimum chi-squared score for primary detection
      improvement: 0.12   # Minimum improvement over baseline

    secondary_threshold:
      score: 0.3          # Secondary detection threshold
      improvement: 0.06   # Secondary improvement threshold

    minimum_threshold:
      score: 0.2          # Minimum viable threshold
      improvement: 0.03   # Minimum improvement

    # Score multipliers and penalties
    primary_multiplier: 2.2     # Score boost for primary detection
    secondary_multiplier: 1.5   # Score boost for secondary detection
    monoalphabetic_boost: 1.3   # Boost for monoalphabetic substitution
    vigenere_penalty: 1.8       # Penalty applied to Vigen√®re-like scores
    transposition_penalty: 1.8  # Penalty applied to transposition scores

  # Text length categories
  text_categories:
    short_threshold: 50  # Texts shorter than this are considered "short"

  # Confidence score thresholds
  confidence_thresholds:
    minimum_family_score: 0.2      # Minimum normalized score for family inclusion
    random_unknown_fallback: 0.7   # Confidence for random-unknown fallback

# Periodic Analysis Configuration
periodic_analysis:
  # Analysis parameters
  analyze:
    minimum_text_length: 10  # Minimum text length for analysis

  # Periodic IC calculation
  periodic_ic:
    minimum_column_length: 5     # Minimum column length for IC calculation
    use_normalized_ic: false     # Whether to use normalized IC
    max_period: 20               # Maximum period to test
    min_period: 1                # Minimum period to test

  # Repetition score calculation
  repetition_score:
    minimum_text_length: 3   # Minimum text length for repetition analysis
    minimum_run_length: 3    # Minimum consecutive identical letters to count

  # General thresholds
  variance_threshold: 0.1   # Variance threshold for periodicity detection
  peak_threshold: 0.08      # Peak threshold for autocorrelation

# Short Text Patterns Configuration
short_text_patterns:
  # Scoring parameters
  score:
    minimum_text_length: 3    # Minimum text length for scoring
    minimum_word_length: 2    # Minimum word length to consider

  # Symmetry analysis
  symmetry_analysis:
    minimum_length: 6     # Minimum length for symmetry analysis
    symmetry_threshold: 1 # Minimum symmetric pairs required

# IC Sample Correction Configuration
ic_analysis:
  # Tolerance values by text category
  tolerance:
    very_short: Infinity   # Very short texts have infinite tolerance
    short: 0.8             # Short texts tolerance
    medium: 0.5            # Medium texts tolerance
    long: 0.3              # Long texts tolerance

  # Percentage tolerance
  tolerance_percent:
    very_short: 50   # 50% tolerance for very short texts
    short: 30        # 30% tolerance for short texts
    medium: 20       # 20% tolerance for medium texts
    long: 10         # 10% tolerance for long texts

  # Expected IC values by language
  expected_values:
    english: 1.73
    french: 2.02
    german: 2.05
    italian: 1.94
    portuguese: 1.94
    spanish: 1.94
    russian: 1.76
    chinese: 0.0